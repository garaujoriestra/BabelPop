angular.module("WallapopTFG").controller("appCtrl",["$auth","$scope","$location","usSpinnerService","$state","states","$translate","checkAuth",function(e,t,a,o,i,n,r,s){t.location=a.path(),t.loading="",t.isLogged=s.isLogged,void 0!==localStorage.getItem("language")&&r.use(localStorage.getItem("language")),t.isAuthenticated=function(){return e.isAuthenticated()},t.noFooter=function(){return""===t.location||"/"===t.location||"/logout"===t.location},t.startSpin=function(){o.spin("spinner-1"),t.loading="pointer-events: none;"},t.stopSpin=function(){o.stop("spinner-1"),t.loading=""},t.redirectLogout=function(){i.go(n.logout)},t.$on("$locationChangeSuccess",function(){t.location=a.path()}),t.$on("startLoadingState",function(){t.startSpin()}),t.$on("stopLoadingState",function(){t.stopSpin()}),t.mainButton=function(){i.go(n.ads)},t.changeLanguage=function(e){localStorage.setItem("language",e),r.use(e)},t.getActualLanguage=function(){return r.use()},t.$on("bornSocket",function(e,a){t.$broadcast("bornSocket2",a)}),t.$on("killSocket",function(e,a){t.$broadcast("killSocket2",a)}),t.$on("openChats",function(e,a){t.$broadcast("openChats2",a)}),t.$on("newChat",function(e,a){t.$broadcast("newChat2",a)})}]),angular.module("WallapopTFG").controller("createAdCtrl",["$scope","$state","states","APIClient","checkAuth","Upload","apiPaths","$timeout","userDataStorage","errorHandler",function(e,t,a,o,i,n,r,s,l,d){i.checkNotLogged(),e.model={},e.model.successAd=!1,e.model.exchange=!1,e.model.negotiable=!1,e.model.send=!1,e.createAdForm=function(){e.model.successAd=!1;var t={};t.title=e.model.title,t.detail=e.model.detail,t.price=e.model.price,t.badge=e.model.currency,t.category=e.model.category,t.tags=[],e.model.tag1=e.model.tag1||void 0,e.model.tag2=e.model.tag2||void 0,e.model.tag3=e.model.tag3||void 0,e.model.tag4=e.model.tag4||void 0,e.model.tag5=e.model.tag5||void 0,void 0!==e.model.tag1&&t.tags.push(e.model.tag1),void 0!==e.model.tag2&&t.tags.push(e.model.tag2),void 0!==e.model.tag3&&t.tags.push(e.model.tag3),void 0!==e.model.tag4&&t.tags.push(e.model.tag4),void 0!==e.model.tag5&&t.tags.push(e.model.tag5),t.exchanges=e.model.exchange||!1,t.negotiable=e.model.negotiable||!1,t.shipments=e.model.send||!1,t.owner=l.getUserData().userName,t.ownerId=l.getUserData().userId;var a=this;o.getUserDetail(l.getUserData().userId).then(function(o){t.latitude=o.latitude,t.longitude=o.longitude,a.uploadPic(e.picFile,t)},function(e){d.handle(e,[500])})},e.uploadPic=function(o,i){e.$emit("startLoadingState"),o.upload=n.upload({url:r.createAd,data:{description:o,ad:i}}),o.upload.then(function(i){s(function(){o.result=i.data,e.$emit("stopLoadingState"),t.go(a.ads)})})["catch"](function(t){e.$emit("stopLoadingState"),d.handle(t)})}}]),angular.module("WallapopTFG").controller("detailAdCtrl",["$scope","$state","$auth","$location","$translate","APIClient","userDataStorage","addetail","tagSplitFilter","states","errorHandler",function(e,t,a,o,i,n,r,s,l,d,u){e.datos={},e.datos=s.ad,e.isFav=function(){if(a.isAuthenticated()){var t=r.getUserData().favAds,o=t.indexOf(e.datos._id);return!(o<0)}},e.iAmTheOwner=function(){return!(!a.isAuthenticated()||e.datos.sold!==!1)&&(e.ownerData=r.getUserData(),e.ownerData.userId===e.datos.ownerId)},e.gotoEditAd=function(e){r.setEditAd(e),t.go(d.editAd)},e.iLikeIt=function(){if(a.isAuthenticated()){var o=r.getUserData().favAds;if(o=o.split(","),o.indexOf(e.datos._id)<0){o.push(e.datos._id),e.datos.likes=e.datos.likes+1,r.setUserfavAds(o);var i={adId:e.datos._id,id:r.getUserData().userId};n.putFavs(i).then(function(){},function(e){u.handle(e)})}else o.splice(o.indexOf(e.datos._id),1),e.datos.likes=e.datos.likes-1,r.setUserfavAds(o),i={adId:e.datos._id,id:r.getUserData().userId},n.putFavs(i).then(function(){},function(e){u.handle(e)})}else t.go(d.mainLogRedirect)},e.shareGoogle=function(){var e="https://plus.google.com/share?url=en.wallapop.com";window.open(e,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},e.shareFacebook=function(){var e="https://www.facebook.com/sharer/sharer.php?u=en.wallapop.com";window.open(e,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},e.shareEmail=function(){var t="",a="";i("SHARE.SUBJECT").then(function(n){t=n+e.datos.title,i("SHARE.BODY").then(function(n){a=n+e.datos.detail,i("SHARE.PRICE").then(function(n){a+="%0A%0A"+n+e.datos.price+e.datos.badge,i("SHARE.LINK").then(function(e){a+="%0A%0A%0A"+e+encodeURI(o.absUrl()),window.location.href="mailto:?subject="+t+"&body="+a})})})})},e.shareTwitter=function(){i("SHARE.TWITTER").then(function(e){var t="https://twitter.com/home?status="+e+o.protocol()+"://"+o.host()+"/%23"+o.path();window.open(t,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")})}}]),angular.module("WallapopTFG").controller("editAdCtrl",["$scope","$state","states","checkAuth","userDataStorage","Upload","apiPaths","$timeout","APIClient","errorHandler",function(e,t,a,o,i,n,r,s,l,d){o.checkNotLogged(),e.model={},e.model.ad=i.getEditAd(),e.picFile=e.model.ad.image,e.errorMessage="",e.editAdForm=function(o){e.errorMessage="",e.model.successAd=!1;var n={};if(n.title=e.model.ad.title,n.detail=e.model.ad.detail,n.price=e.model.ad.price,n.badge=e.model.ad.badge,n.category=e.model.ad.category,n.tags=[],e.model.tag1=e.model.tag1||void 0,e.model.tag2=e.model.tag2||void 0,e.model.tag3=e.model.tag3||void 0,e.model.tag4=e.model.tag4||void 0,e.model.tag5=e.model.tag5||void 0,void 0!==e.model.ad.tags[0]&&n.tags.push(e.model.ad.tags[0]),void 0!==e.model.ad.tags[1]&&n.tags.push(e.model.ad.tags[1]),void 0!==e.model.ad.tags[2]&&n.tags.push(e.model.ad.tags[2]),void 0!==e.model.ad.tags[3]&&n.tags.push(e.model.ad.tags[3]),void 0!==e.model.ad.tags[4]&&n.tags.push(e.model.ad.tags[4]),n.exchanges=e.model.ad.exchanges||!1,n.negotiable=e.model.ad.negotiable||!1,n.shipments=e.model.ad.shipments||!1,n.owner=i.getUserData().userName,n.ownerId=i.getUserData().userId,n.adId=e.model.ad._id,n.userId=i.getUserData().userId,n.sold=e.model.ad.sold,e.model.ad.purchaser=e.model.ad.purchaser||void 0,void 0!==e.model.ad.purchaser&&(n.purchaser=e.model.ad.purchaser),e.model.ad.sold===!1&&(n.purchaser=""),e.$emit("startLoadingState"),"image/png"===e.picFile.type||"image/jpeg"===e.picFile.type||"image/jpg"===e.picFile.type)this.uploadPic(e.picFile,n,o);else if(void 0!==e.picFile){var s={ad:n,purchaserId:o,userId:i.getUserData().userId};l.apiPutRequest(r.editAd,s).then(function(){e.$emit("stopLoadingState"),t.go(a.ads)})["catch"](function(t){d.handle(t,[409]),void 0!==t&&e.errorHandling(t),e.$emit("stopLoadingState")})}},e.uploadPic=function(o,i,s){o.upload=n.upload({url:r.editAd,data:{description:o,ad:i,purchaserId:s},method:"PUT"}),o.upload.then(function(i){o.result=i.data,e.$emit("stopLoadingState"),t.go(a.ads)})["catch"](function(t){d.handle(t,[409]),e.errorHandling(t.data),e.$emit("stopLoadingState")})},e.errorHandling=function(t){if(e.errorMessage=t.translation,e.foundUsers=t.users,void 0!==t.users)for(var a=0;a<t.users.length;a++)void 0===t.users[a].photoSocial&&(t.users[a].photoSocial="http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-6.jpg"),void 0===t.users[a].rating&&(t.users[a].rating=0)}}]),angular.module("WallapopTFG").controller("adsCtrl",["$scope","$state","$auth","apiPaths","APIClient","userDataStorage","checkAuth","states","errorHandler",function(e,t,a,o,i,n,r,s,l){e.model=[],e.favCat=[],e.$emit("startLoadingState"),i.getAds(o.getAds).then(function(t){e.model=t,e.$emit("stopLoadingState")},function(t){e.$emit("stopLoadingState"),l.handle(t)}),e.isFav=function(e){if(a.isAuthenticated()){var t=n.getUserData().favAds,o=t.indexOf(e._id);return!(o<0)}},e.iLikeIt=function(e){if(a.isAuthenticated()){var o=n.getUserData().favAds;o=o.split(",");var r;o.indexOf(e._id)<0?(o.push(e._id),e.likes=e.likes+1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(e)})):(o.splice(o.indexOf(e._id),1),e.likes=e.likes-1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(e)}))}else t.go(s.mainLogRedirect)},e.collapse=function(){angular.element("#toggleAdv").addClass("active")},e.categories=[],e.categories.push("CAT1"),e.categories.push("CAT2"),e.categories.push("CAT3"),e.categories.push("CAT4"),e.categories.push("CAT5"),e.categories.push("CAT6"),e.categories.push("CAT7"),e.categories.push("CAT8"),e.categories.push("CAT9"),e.categories.push("CAT10"),e.categories.push("CAT11"),e.categories.push("CAT12"),e.goSearch=function(a,o){var i="",n="/api/getAds?";for(var r in e.favCat)i=e.favCat[r],n+=r!==e.favCat.length-1?"category="+i+"&":"category="+i;void 0!==a&&0!==e.favCat.length?n+="&location="+a:void 0!==a&&0===e.favCat.length&&(n+="location="+a),void 0===o||0===e.favCat.length&&void 0===a?void 0!==o&&0===e.favCat.length&&void 0===a&&(n+="sort="+o):n+="&sort="+o,void 0===e.model.min||void 0!==e.model.max||0===e.favCat.length&&void 0===a&&void 0===o?void 0===e.model.min||void 0===e.model.max||0===e.favCat.length&&void 0===a&&void 0===o||(n+="&price="+e.model.min+"-"+e.model.max):n+="&price="+e.model.min+"-",void 0!==e.model.min&&void 0===e.model.max&&0===e.favCat.length&&void 0===a&&void 0===o?n+="price="+e.model.min+"-":void 0!==e.model.min&&void 0!==e.model.max&&0===e.favCat.length&&void 0===a&&void 0===o&&(n+="price="+e.model.min+"-"+e.model.max),void 0===e.model.adName||void 0===e.model.min&&void 0!==e.model.max&&0===e.favCat.length&&void 0===a&&void 0===o?void 0!==e.model.adName&&void 0===e.model.min&&void 0===e.model.max&&0===e.favCat.length&&void 0===a&&void 0===o&&(n+="title="+e.model.adName):n+="&title="+e.model.adName,t.go(s.advancedSearch,{cosas:n})}}]),angular.module("WallapopTFG").controller("filterAdsAdvCtrl",["$scope","$state","$auth","apiPaths","APIClient","userDataStorage","checkAuth","states","errorHandler","filteradv",function(e,t,a,o,i,n,r,s,l,d){e.model=d.data,e.isFav=function(e){if(a.isAuthenticated()){var t=n.getUserData().favAds,o=t.indexOf(e._id);return!(o<0)}},e.iLikeIt=function(e){if(a.isAuthenticated()){var o=n.getUserData().favAds;o=o.split(",");var r;o.indexOf(e._id)<0?(o.push(e._id),e.likes=e.likes+1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(e)})):(o.splice(o.indexOf(e._id),1),e.likes=e.likes-1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(e)}))}else t.go(s.mainLogRedirect)},e.backAds=function(){t.go(s.ads)}}]),angular.module("WallapopTFG").controller("filterAdsCtrl",["$scope","$state","$auth","apiPaths","APIClient","userDataStorage","checkAuth","states","errorHandler","filtcartego",function(e,t,a,o,i,n,r,s,l,d){e.model=d.data,e.isFav=function(e){if(a.isAuthenticated()){var t=n.getUserData().favAds,o=t.indexOf(e._id);return!(o<0)}},e.iLikeIt=function(e){if(a.isAuthenticated()){var o=n.getUserData().favAds;o=o.split(",");var r;o.indexOf(e._id)<0?(o.push(e._id),e.likes=e.likes+1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(error)})):(o.splice(o.indexOf(e._id),1),e.likes=e.likes-1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(e)}))}else t.go(s.mainLogRedirect)},e.backAds=function(){t.go(s.ads)}}]),angular.module("WallapopTFG").controller("filterAdsNameCtrl",["$scope","$state","$auth","apiPaths","APIClient","userDataStorage","checkAuth","states","errorHandler","filtername",function(e,t,a,o,i,n,r,s,l,d){e.model=d.data,e.isFav=function(e){if(a.isAuthenticated()){var t=n.getUserData().favAds,o=t.indexOf(e._id);return!(o<0)}},e.iLikeIt=function(e){if(a.isAuthenticated()){var o=n.getUserData().favAds;o=o.split(",");var r;o.indexOf(e._id)<0?(o.push(e._id),e.likes=e.likes+1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(e)})):(o.splice(o.indexOf(e._id),1),e.likes=e.likes-1,n.setUserfavAds(o),r={adId:e._id,id:n.getUserData().userId},i.putFavs(r).then(function(){},function(e){l.handle(e)}))}else t.go(s.mainLogRedirect)},e.backAds=function(){t.go(s.ads)}}]),angular.module("WallapopTFG").controller("chatCtrl",["$scope","APIClient","userDataStorage","errorHandler",function(e,t,a,o){e.showUsers=!0,e.room=0,e.rooms=[],e.newChats=!1,e.newMessages=0,t.getChats(a.getUserData().userId).then(function(i){for(var n=0;n<i.length;n++)i[n].userId2===a.getUserData().userId?t.getUser(i[n].userId1).then(function(t){t.newMessages=0,e.rooms.push(t)},function(e){o.handle(e)}):t.getUser(i[n].userId2).then(function(t){t.newMessages=0,e.rooms.push(t)},function(e){o.handle(e)})},function(e){o.handle(e)}),e.openChat=function(t){e.newChats=!1,e.showUsers=!1,e.newMessages-=e.rooms[t].newMessages,e.rooms[t].newMessages=0,e.room=e.rooms[t],e.$broadcast("openedChat")},e.closeChat=function(){e.showUsers=!0,e.room=0},e.$on("openChats2",function(t,a){angular.element("#collapseChat").collapse("show"),e.rooms.push(a),e.openChat(e.rooms.length-1)}),e.$on("newChatRoom",function(t,a){a.connected=!0,e.rooms.push(a),e.newChats=!0}),e.$on("newMessage",function(t,a){for(var o=!1,i=0;i<e.rooms.length&&!o;i++)e.rooms[i]._id===a&&e.room._id!==a&&(e.newMessages++,e.rooms[i].newMessages++)}),e.$on("updateConnectedSockets",function(t,a){for(var o,i=Object.keys(a),n=0;n<e.rooms.length;n++){o=!1;for(var r=0;r<i.length&&!o;r++)e.rooms[n]._id===i[r]&&(e.rooms[n].connected=!0,o=!0)}}),e.$on("newSocketConnected",function(t,a){for(var o=!1,i=0;i<e.rooms.length&&!o;i++)e.rooms[i]._id===a&&(e.rooms[i].connected=!0,o=!0)}),e.$on("newSocketDisconnected",function(t,a){for(var o=!1,i=0;i<e.rooms.length&&!o;i++)e.rooms[i]._id===a&&(e.rooms[i].connected=!1,o=!0)})}]),angular.module("WallapopTFG").controller("chatWindowCtrl",["$log","$scope","chatSocket","userDataStorage","APIClient","errorHandler",function(e,t,a,o,i,n){var r=a();t.messageLog=[],t.message="",t.askerId=o.getUserData().userId,t.askerUsername=o.getUserData().userName,t.send_individual_msg=function(){t.message=t.message||"",""!==t.message&&r.emit("check_user",t.askerId,t.room._id)},r.on("connect",function(){r.emit("adduser",t.askerId)}),r.on("msg_asker_handle",function(e){t.messageLog.push(e)}),r.on("msg_target_handle",function(e){t.messageLog.push(e),t.$emit("newMessage",e.user)}),r.on("msg_user_found",function(e){r.emit("msg_user",e,t.askerId,t.askerUsername,t.message),t.message=""}),r.on("requestConnectedSockets",function(e){t.$emit("updateConnectedSockets",e)}),r.on("connectedSocket",function(e){t.$emit("newSocketConnected",e)}),r.on("disconnectedSocket",function(e){t.$emit("newSocketDisconnected",e)}),t.$on("killSocket2",function(){r.emit("kill")}),t.$on("bornSocket2",function(e,t){r.emit("adduser",t)}),t.$on("openedChat",function(){i.getChatMessages(o.getUserData().userId,t.room._id).then(function(e){t.messageLog=e},function(e){n.handle(e)})}),t.$on("newChat2",function(e,t){r.emit("newChatRoom",t,o.getUserData().userId)}),r.on("newChatRoom",function(e){i.getUser(e).then(function(e){t.$emit("newChatRoom",e)},function(e){n.handle(e)})})}]),angular.module("WallapopTFG").controller("headerCtrl",["$scope","$location","$rootScope","$auth","$state","states","userDataStorage",function(e,t,a,o,i,n,r){e.userName="",e.profilePicture="http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-6.jpg",e.title="",e.categories=[],e.categories.push("CAT1"),e.categories.push("CAT2"),e.categories.push("CAT3"),e.categories.push("CAT4"),e.categories.push("CAT5"),e.categories.push("CAT6"),e.categories.push("CAT7"),e.categories.push("CAT8"),e.categories.push("CAT9"),e.categories.push("CAT10"),e.categories.push("CAT11"),e.categories.push("CAT12"),e.logoClick=function(){i.go(n.home)},a.$on("updateUserData",function(){e.setUserData()}),e.filterByName=function(){i.go(n.filterAdsName,{name:e.title}),e.title=""},e.setUserData=function(){if(o.isAuthenticated()){var t=r.getUserData();e.userName=t.userName,e.profilePicture=t.profilePicture,e.userId=r.getUserData().userId}},e.setUserData()}]),angular.module("WallapopTFG").controller("editLocationCtrl",["$scope","checkAuth","NgMap","APIClient","$state","userDataStorage","states","errorHandler",function(e,t,a,o,i,n,r,s){t.checkNotLogged(),e.writable=!1,e.cnt1,e.cnt2,o.getLocation().then(function(t){var a=t;null!=a.latitude&&null!=a.longitude?(e.lat=a.latitude,e.lng=a.longitude,e.cnt1=e.lat,e.cnt2=e.lng):(e.lat=40.439427,e.lng=-3.678786,e.cnt1=e.lat,e.cnt2=e.lng)},function(e){s.handle(e)}),e.addMarker=function(t){if(e.writable!==!0){var a=t.latLng;e.lat=a.lat(),e.lng=a.lng()}},e.editLocation=function(){e.$emit("startLoadingState");var t={};e.writable===!0?(t.livingArea=e.address,t.latitude=void 0,t.longitude=void 0):(t.livingArea=void 0,t.latitude=e.lat,t.longitude=e.lng),o.updateLocation(t).then(function(){e.$emit("stopLoadingState"),i.go(r.detailUser,{_id:n.getUserData().userId})},function(t){e.$emit("stopLoadingState"),s.handle(t)})},e.$watch("address",function(){e.cnt1=e.address,e.cnt2=e.address})}]),angular.module("WallapopTFG").controller("customLogLayoutCtrl",["$scope","paths","checkAuth",function(e,t,a){a.checkLogged()}]),angular.module("WallapopTFG").controller("customLoginCtrl",["$auth","$location","$scope","$state","states","userDataStorage","errorHandler",function(e,t,a,o,i,n,r){a.model={},a.login=function(){a.$emit("startLoadingState"),e.login({email:a.model.email,pass:a.model.password}).then(function(e){n.setUserData(e.data.name,e.data.photo,e.data.id,e.data.favAds),a.$emit("stopLoadingState"),a.$emit("bornSocket",e.data.id),o.go(i.detailUser,{_id:n.getUserData().userId})})["catch"](function(e){a.$emit("stopLoadingState"),r.handle(e,[401]),a.logError=e.status})},a.redirectSignup=function(){o.go(i.customSignup)},a.goToRecover=function(){o.go(i.forgotten)}}]),angular.module("WallapopTFG").controller("customSignupCtrl",["$auth","$location","$scope","$state","states","checkAuth","userDataStorage",function(e,t,a,o,i,n,r){n.checkLogged(),a.model={},a.signup=function(){a.$emit("startLoadingState"),e.signup({name:a.model.name,email:a.model.email,pass:a.model.password}).then(function(){e.login({email:a.model.email,pass:a.model.password}).then(function(e){r.setUserData(e.data.name,e.data.photo,e.data.id),a.$emit("stopLoadingState"),a.$emit("bornSocket",e.data.id),o.go(i.detailUser,{_id:e.data.id})})["catch"](function(e){a.$emit("stopLoadingState"),a.logError=e.status})})["catch"](function(e){a.$emit("stopLoadingState"),a.logError=e.status})},a.redirectLogin=function(){o.go(i.customLogin)}}]),angular.module("WallapopTFG").controller("forgottenCtrl",["$scope","$state","states","apiPaths","APIClient","checkAuth","errorHandler",function(e,t,a,o,i,n,r){e.model={},n.checkLogged(),e.recoverPassword=function(){var n=localStorage.getItem("language"),s={email:e.model.email,lang:n};i.apiPostRequest(o.forgotten,s).then(function(){t.go(a.customLogin)},function(e){r.handle(e)})}}]),angular.module("WallapopTFG").controller("mainLogLayoutCtrl",["$scope","$auth","$state","states","checkAuth","userDataStorage","errorHandler",function(e,t,a,o,i,n,r){i.checkLogged(),e.authenticate=function(e){t.authenticate(e).then(function(e){n.setUserData(e.data.name,e.data.photo,e.data.id,e.data.favAds),a.go(o.detailUser,{_id:n.getUserData().userId})})["catch"](function(e){r.handle(e)})},e.login=function(){a.go(o.customLogin)},e.signup=function(){a.go(o.customSignup)}}]),angular.module("WallapopTFG").controller("logoutCtrl",["$auth","$scope","checkAuth","$state","states","userDataStorage","errorHandler",function(e,t,a,o,i,n,r){a.checkNotLogged(),t.logout=function(){t.$emit("startLoadingState"),e.logout().then(function(){n.removeUserData(),t.$emit("stopLoadingState"),t.$emit("killSocket"),o.go(i.home)})["catch"](function(e){t.$emit("stopLoadingState"),r.handle(e)})},t.stay=function(){o.go(i.home)}}]),angular.module("WallapopTFG").controller("editProfileCtrl",["$scope","$rootScope","$filter","$timeout","$state","states","apiPaths","APIClient","userDataStorage","checkAuth","Upload","edituser","errorHandler",function(e,t,a,o,i,n,r,s,l,d,u,c,g){d.checkNotLogged(),e.userData=c.data,e.userId=e.userData._id;var m=e.userData.name.split(" ");e.userData.name=m[0],e.userData.surname="";for(var p=1;p<m.length;p++)1!==p&&(e.userData.surname+=" "),e.userData.surname+=m[p];void 0!==e.userData.birthDate&&(e.userData.birthDate=new Date(e.userData.birthDate)),e.userData.google||e.userData.facebook?e.loggedWithForG=!0:e.loggedWithForG=!1,e.uploadProfilePicture=function(t,a){e.$emit("startLoadingState");var o=r.editProfilePicture+e.userData._id;u.upload({url:o,method:"PUT",data:{avatar:u.dataUrltoBlob(t,a)}}).then(function(t){l.setUserPicture(t.data.imageRoute),i.go(n.detailUser,{_id:e.userData._id}),location.reload(),e.$emit("stopLoadingState")})["catch"](function(t){e.$emit("stopLoadingState"),g.handle(t)})},e.setMale=function(t){e.gender="male",t.$pristine=!1,t.$dirty=!0,angular.element("#setFemaleButton").removeClass("active")},e.setFemale=function(t){e.gender="female",t.$pristine=!1,t.$dirty=!0,angular.element("#setMaleButton").removeClass("active")},e.submit=function(t){var a={};""!==t.name.$modelValue.trim()&&""!==t.surname.$modelValue.trim()&&(a.name=t.name.$modelValue.trim()+" "+t.surname.$modelValue.trim(),l.setUserName(a.name)),a.birthDate=t.birthDate.$modelValue||"",a.gender=e.gender||void 0,a.phone=t.phone.$modelValue||"",s.putUser(e.userData._id,a),i.go(n.detailUser,{_id:e.userData._id})},e.submitPass=function(t){var a={};t.newPass.$modelValue===t.confirmPass.$modelValue?(a.prevPass=t.oldPass.$modelValue,a.pass=t.newPass.$modelValue,e.errorMessage=void 0,s.putPass(e.userData._id,a).then(function(){i.go(n.detailUser,{_id:e.userData._id})},function(t){g.handle(t,[409]),void 0!==t&&(e.errorMessage="EDITPROFILE.WRONGOLDPWD")})):e.errorMessage="EDITPROFILE.WRONGNEWPWD"},e.submitEmail=function(){var t={};t.email=e.userData.email,s.putEmail(e.userData._id,t).then(function(){i.go(n.detailUser,{_id:e.userData._id})},function(e){g.handle(e)})},e.submitCategories=function(){var t={};t.favCat=e.userData.favCat,s.putCategories(e.userData._id,t).then(function(){i.go(n.detailUser,{_id:e.userData._id})},function(e){g.handle(e)})},e.redirectLocation=function(){i.go(n.editLocation)},e.gotoProfile=function(){i.go(n.detailUser,{_id:e.userData._id})},e.collapsePass=function(){angular.element("#togglePass").addClass("active"),angular.element("#toggleEmail").removeClass("active"),angular.element("#toggleCat").removeClass("active"),angular.element("#collapse2").collapse("hide"),angular.element("#collapse3").collapse("hide")},e.collapseEmail=function(){angular.element("#togglePass").removeClass("active"),angular.element("#toggleEmail").addClass("active"),angular.element("#toggleCat").removeClass("active"),angular.element("#collapse1").collapse("hide"),angular.element("#collapse3").collapse("hide")},e.collapseCat=function(){angular.element("#togglePass").removeClass("active"),angular.element("#toggleEmail").removeClass("active"),angular.element("#toggleCat").addClass("active"),angular.element("#collapse1").collapse("hide"),angular.element("#collapse2").collapse("hide")},e.categories=[],e.categories.push("CAT1"),e.categories.push("CAT2"),e.categories.push("CAT3"),e.categories.push("CAT4"),e.categories.push("CAT5"),e.categories.push("CAT6"),e.categories.push("CAT7"),e.categories.push("CAT8"),e.categories.push("CAT9"),e.categories.push("CAT10"),e.categories.push("CAT11"),e.categories.push("CAT12")}]),angular.module("WallapopTFG").controller("profileCtrl",["$scope","$rootScope","$auth","$location","$filter","$translate","checkAuth","userDataStorage","APIClient","$state","states","userdetail","errorHandler",function(e,t,a,o,i,n,r,s,l,d,u,c,g){e.userData=c.data,e.userId=e.userData._id,e.soldData=[],e.saleData=[],e.favAdsData=[],void 0===e.userData.photoSocial&&(e.userData.photoSocial="http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-6.jpg");var m=i("date")(e.userData.birthDate,"dd/MM/yyyy")||"-",p=e.userData.gender||"-",h=e.userData.phone||"-";n("PROFILE.TOOLTIP.BIRTHDAY").then(function(t){e.birthday=t+m,n("PROFILE.TOOLTIP.GENDER").then(function(t){e.gender=t+p,n("PROFILE.TOOLTIP.PHONE").then(function(t){e.phone=t+h,n("PROFILE.TOOLTIP.LOCATION").then(function(t){e.location=t,e.tooltip={birthday:e.birthday,location:e.location,gender:e.gender,phone:e.phone}})})})}),l.getUserSold(e.userData._id).then(function(t){e.soldData=t},function(e){g.handle(e)}),l.getUserSale(e.userData._id).then(function(t){e.saleData=t},function(e){g.handle(e)}),l.getUserFavAds(e.userData._id).then(function(t){e.favAdsData=t},function(e){g.handle(e)}),e.canIEdit=function(){return a.isAuthenticated()&&s.getUserData().userId===e.userData._id},e.gotoEdit=function(){d.go(u.editProfile,{_id:e.userId})},e.gotoCreateAd=function(){d.go(u.createAd)},e.mouseEnterProfilePicture=function(){angular.element(".btn-profile-picture-edit").addClass("hover")},e.mouseLeaveProfilePicture=function(){angular.element(".btn-profile-picture-edit").removeClass("hover")},$(document).ready(function(){$("[data-toggle=tooltip1]").hover(function(){$(this).tooltip("show")},function(){$(this).tooltip("hide")}),$("[data-toggle=tooltip2]").hover(function(){$(this).tooltip("show")},function(){$(this).tooltip("hide")}),$("[data-toggle=tooltip3]").hover(function(){$(this).tooltip("show")},function(){$(this).tooltip("hide")}),$("[data-toggle=tooltip4]").hover(function(){$(this).tooltip("show")},function(){$(this).tooltip("hide")})}),e.collapseSale=function(){angular.element("#toggleSale").addClass("active"),angular.element("#toggleSold").removeClass("active"),angular.element("#toggleReviews").removeClass("active"),angular.element("#toggleFavAds").removeClass("active"),angular.element("#collapse2").collapse("hide"),angular.element("#collapse3").collapse("hide"),angular.element("#collapse4").collapse("hide")},e.collapseSold=function(){angular.element("#toggleSale").removeClass("active"),angular.element("#toggleSold").addClass("active"),angular.element("#toggleReviews").removeClass("active"),angular.element("#toggleFavAds").removeClass("active"),angular.element("#collapse1").collapse("hide"),angular.element("#collapse3").collapse("hide"),angular.element("#collapse4").collapse("hide")},e.collapseReviews=function(){angular.element("#toggleSale").removeClass("active"),angular.element("#toggleSold").removeClass("active"),angular.element("#toggleReviews").addClass("active"),angular.element("#toggleFavAds").removeClass("active"),angular.element("#collapse1").collapse("hide"),angular.element("#collapse2").collapse("hide"),angular.element("#collapse4").collapse("hide")},e.collapseFavAds=function(){angular.element("#toggleSale").removeClass("active"),angular.element("#toggleSold").removeClass("active"),angular.element("#toggleReviews").removeClass("active"),angular.element("#toggleFavAds").addClass("active"),angular.element("#collapse1").collapse("hide"),angular.element("#collapse2").collapse("hide"),angular.element("#collapse3").collapse("hide")},e.gotoEditAd=function(e){s.setEditAd(e),d.go(u.editAd)},e.deleteAd=function(t){var a=s.getUserId(),o=t._id;l.deleteAd(a,o).then(function(t){e.userData=t.data[0],l.getUserSold(e.userData._id).then(function(t){e.soldData=t,l.getUserSale(e.userData._id).then(function(t){e.saleData=t,l.getUserFavAds(e.userData._id).then(function(t){e.favAdsData=t},function(e){g.handle(e)})},function(e){g.handle(e)})},function(e){g.handle(e)})},function(e){g.handle(e)})},e.cnt1,e.cnt2,e.zoom=11,""!==e.userData.latitude&&null!==e.userData.latitude&&void 0!==e.userData.latitude?(e.cnt1=e.userData.latitude,e.cnt2=e.userData.longitude):""!==e.userData.livingArea&&null!==e.userData.livingArea&&void 0!==e.userData.livingArea?(e.cnt1=e.userData.livingArea,e.cnt2=e.userData.livingArea):e.zoom=1,e.chat=function(){l.isNewChat(s.getUserData().userId,e.userId).then(function(t){t?l.newChat(s.getUserData().userId,e.userId).then(function(t){e.$emit("openChats",e.userData),e.$emit("newChat",e.userData)},function(e){console.log("ERROR AL CREAR NUEVO CHAT")}):e.$emit("openChats",e.userData)},function(e){g.handle(e)})}}]),angular.module("WallapopTFG",["ui.router","satellizer","angularSpinner","pascalprecht.translate","ngFileUpload","ngMap","checklist-model","frapontillo.bootstrap-switch","ngFileUpload","ngImgCrop","btford.socket-io","luegg.directives"]).value("messageFormatter",function(e,t,a){return e.toLocaleTimeString()+" - "+t+" - "+a+"\n"}).config(["$stateProvider","$urlRouterProvider","$authProvider","paths","states","usSpinnerConfigProvider","$translateProvider","$httpProvider",function(e,t,a,o,i,n,r,s){t.otherwise("/error404"),e.state(i.error404,{url:o.error404,templateUrl:"../modules/error/error404.html"}).state(i.error500,{url:o.error500,templateUrl:"../modules/error/error500.html"}).state(i.errorUnknown,{url:o.errorUnknown,templateUrl:"../modules/error/errorUnknown.html"}).state(i.home,{url:o.home,templateUrl:"../modules/home/home.html"}).state(i.root,{url:o.root,templateUrl:"../modules/home/home.html"}).state(i.terms,{url:o.terms,templateUrl:"../modules/terms/terms.html"}).state(i.privacy,{url:o.privacy,templateUrl:"../modules/terms/privacy.html"}).state(i.mainLogLayout,{templateUrl:"../modules/login/mainLogLayout.html"}).state(i.mainLog,{url:o.mainLog,templateUrl:"../modules/login/mainLog.html",parent:i.mainLogLayout}).state(i.mainLogRedirect,{url:o.mainLogRedirect,templateUrl:"../modules/login/mainLogRedirect.html",parent:i.mainLogLayout}).state(i.customLogLayout,{templateUrl:"../modules/login/customLogLayout.html"}).state(i.customLogin,{url:o.customLogin,templateUrl:"../modules/login/customLogin.html",parent:i.customLogLayout}).state(i.customSignup,{url:o.customSignup,templateUrl:"../modules/login/customSignup.html",parent:i.customLogLayout}).state(i.privateLayout,{templateUrl:"../modules/private/privateLayout.html"}).state(i.logout,{url:o.logout,templateUrl:"../modules/logout/logout.html"}).state(i.detailUser,{url:o.detailUser,params:{_id:null},templateUrl:"../modules/profile/profile.html",controller:"profileCtrl",resolve:{userdetail:["$stateParams","APIClient",function(e,t){return t.getUser(e._id).then(function(e){return{data:e}},function(e){return{err:e}})}]}}).state(i.createAd,{url:o.createAd,templateUrl:"../modules/ad/createAd.html"}).state(i.editProfile,{url:o.editProfile,params:{_id:null},templateUrl:"../modules/profile/editProfile.html",controller:"editProfileCtrl",resolve:{edituser:["$stateParams","APIClient",function(e,t){return t.getUser(e._id).then(function(e){return{data:e}},function(e){return{err:e}})}]}}).state(i.ads,{url:o.ads,templateUrl:"../modules/ads/ads.html",controller:"adsCtrl"}).state(i.filterAds,{url:o.filterAds,params:{cat:null},templateUrl:"../modules/ads/filterAds.html",controller:"filterAdsCtrl",resolve:{filtcartego:["$stateParams","APIClient",function(e,t){return t.filterByCategory(e.cat).then(function(e){return{data:e}},function(e){return{err:e}})}]}}).state(i.filterAdsName,{url:o.filterAdsName,params:{name:null},templateUrl:"../modules/ads/filterAdsName.html",controller:"filterAdsNameCtrl",resolve:{filtername:["$stateParams","APIClient",function(e,t){return t.filterByName(e.name).then(function(e){return{data:e}},function(e){return{err:e}})}]}}).state(i.editLocation,{url:o.editLocation,templateUrl:"../modules/location/editLocation.html"}).state(i.editAd,{url:o.editAd,templateUrl:"../modules/ad/editAd.html"}).state(i.detailAd,{url:o.detailAd,params:{_id:null},resolve:{addetail:["$stateParams","APIClient",function(e,t){return t.getDetailAd(e._id).then(function(e){return{ad:e}},function(e){return{err:e}})}]},templateUrl:"../modules/ad/detailAd.html",controller:"detailAdCtrl"}).state(i.forgotten,{url:o.forgotten,templateUrl:"../modules/login/forgotten.html"}).state(i.advancedSearch,{url:o.advancedSearch,templateUrl:"../modules/ads/filterAdsAdv.html",
controller:"filterAdsAdvCtrl",params:{cosas:null},resolve:{filteradv:["$stateParams","APIClient",function(e,t){return t.filterAdvanced(e.cosas).then(function(e){return{data:e}},function(e){return{err:e}})}]}}),a.loginUrl="/api/login",a.signupUrl="/api/signUp",a.tokenName="token",a.tokenPrefix="WallapopTFG",a.facebook({clientId:"1026244750795684",url:"/api/auth/facebook"}),a.google({clientId:"587284002320-dec99stb9tjtj3fehmf951sfe6v440gm.apps.googleusercontent.com",url:"/api/auth/google"}),n.setDefaults({position:"fixed"}),n.setTheme("bigBlue",{color:"#FF4081",radius:20}),n.setTheme("smallRed",{color:"red",radius:6}),r.useStaticFilesLoader({prefix:"dictionaries/locale-",suffix:".json"}).preferredLanguage("es_ES"),r.useSanitizeValueStrategy("escape"),s.interceptors.push("httpRequestInterceptor")}]),angular.module("WallapopTFG").constant("apiPaths",{getAd:"/api/getAds/",postAd:"/api/createAd",getUsers:"/api/users/",getUser:"/api/users/",getAds:"/api/getAds/",postLogin:"/api/login/",postUser:"/api/signUp/",loginGoogle:"/api/auth/google/",loginFacebook:"/api/auth/facebook/",createAd:"/api/createAd",photoAd:"/api/photo-ad",putLocation:"/api/location/",getLocation:"/api/location/",editProfilePicture:"/api/photo/",editProfile:"/api/infoUser/",editEmail:"/api/email/",editPass:"/api/pass/",editCat:"/api/categories/",profileSold:"/api/sold/",profileSale:"/api/sale/",profileFavAds:"api/favAds/",editAd:"/api/editAd/",pushIdAd:"/api/pushIdAd/",detailAd:"/api/getAds/",editFavs:"/api/editFavs/",deleteAd:"/api/deleteAd",forgotten:"/api/forgotten",isNewChat:"/api/isNewChat",newChat:"/api/createChat",getChats:"/api/getChats/",categories:"/api/getAds?category=",byName:"/api/getAds?title=",getChatMessages:"/api/getChatMessages/"}),angular.module("WallapopTFG").constant("LOCALES",{locales:{es_ES:"Español",en_US:"English"},preferredLocale:"en_US"}),angular.module("WallapopTFG").constant("paths",{error404:"/error404",error500:"/error500",errorUnknown:"/errorUnknown",home:"/",root:"",terms:"/terms",privacy:"/priv",mainLog:"/log",mainLogRedirect:"/logPlease",customLogin:"/login",customSignup:"/signup",logout:"/logout",createAd:"/createAd",profile:"/profile",editProfile:"/profile/:_id/edit",ads:"/ads",filterAds:"/ads-categories/?=:cat",filterAdsName:"/ads-search/?=:name",editLocation:"/editLocation",detailAd:"/ads/:_id",editAd:"/editAd",detailUser:"/profile/:_id",forgotten:"/forgotten",advancedSearch:"/ads-advancedSearch/:cosas"}),angular.module("WallapopTFG").constant("states",{error404:"error404",error500:"error500",errorUnknown:"errorUnknown",home:"home",root:"root",terms:"terms",privacy:"privacy",mainLogLayout:"mainLogLayout",mainLog:"mainLog",mainLogRedirect:"mainLogRedirect",customLogLayout:"customLogLayout",customLogin:"customLogin",customSignup:"customSignup",privateLayout:"privateLayout",logout:"logout",profile:"profile",createAd:"createAd",editProfile:"editProfile",ads:"ads",filterAds:"filterAds",filterAdsName:"filterAdsName",editLocation:"editLocation",detailAd:"detailAd",editAd:"editAd",detailUser:"detailUser",forgotten:"forgotten",advancedSearch:"advancedSearch"}),angular.module("WallapopTFG").directive("ngReallyClick",[function(){return{restrict:"A",link:function(e,t,a){t.bind("click",function(){var t=a.ngReallyMessage;t&&confirm(t)&&e.$apply(a.ngReallyClick)})}}}]),angular.module("WallapopTFG").factory("chatSocket",["socketFactory",function(e){return function(){var t=e();return t.forward("broadcast"),t}}]),angular.module("WallapopTFG").factory("httpRequestInterceptor",function(){return{request:function(e){return e}}}),angular.module("WallapopTFG").filter("tagSplit",function(){return function(e){var t="tags: ";if(e.length>0){for(var a=0;a<e.length-1;a++)t+=e[a]+", ";t+=e[e.length-1]}else t+="-";return t}}),angular.module("WallapopTFG").filter("timeago",function(){return function(e,t){var a,o=function(e,t,a){var o=$.isFunction(e)?e(t,l):e,i=a.numbers&&a.numbers[t]||t;return o.replace(/%d/i,i)},i=(new Date).getTime(),n=new Date(e).getTime(),r=t||!1,s={prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years"},l=i-n,d=Math.abs(l)/1e3,u=d/60,c=u/60,g=c/24,m=g/365,p=void 0===s.wordSeparator?" ":s.wordSeparator,h=s.prefixAgo,f=s.suffixAgo;return r&&l<0&&(h=s.prefixFromNow,f=s.suffixFromNow),a=d<45&&o(s.seconds,Math.round(d),s)||d<90&&o(s.minute,1,s)||u<45&&o(s.minutes,Math.round(u),s)||u<90&&o(s.hour,1,s)||c<24&&o(s.hours,Math.round(c),s)||c<42&&o(s.day,1,s)||g<30&&o(s.days,Math.round(g),s)||g<45&&o(s.month,1,s)||g<365&&o(s.months,Math.round(g/30),s)||m<1.5&&o(s.year,1,s)||o(s.years,Math.round(m),s),$.trim([h,a,f].join(p))}}),angular.module("WallapopTFG").service("APIClient",["$http","$q","apiPaths","userDataStorage",function(e,t,a,o){this.apiGetRequest=function(a){var o=t.defer();return e.get(a).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise},this.apiPostRequest=function(a,o){var i=t.defer();return e.post(a,o).then(function(e){i.resolve(e.data)},function(e){i.reject(e.data)}),i.promise},this.apiPutRequest=function(a,o){var i=t.defer();return e.put(a,o).then(function(e){i.resolve(e.data)},function(e){i.reject(e.data)}),i.promise},this.updateLocation=function(i){var n=t.defer(),r=o.getUserId();return e.put(a.putLocation+r,i).then(function(e){n.resolve(e.data)},function(e){n.reject(e.data)}),n.promise},this.getLocation=function(){var e=o.getUserId();return this.apiGetRequest(a.getLocation+e)},this.getUser=function(e){return this.apiGetRequest(a.getUsers+e)},this.getUserDetail=function(e){return this.apiGetRequest(a.getUser+e)},this.putAd=function(e,t){return this.apiPutRequest(a.editAd+e,t)},this.putIdAd=function(e,t){return this.apiPutRequest(a.pushIdAd+e,t)},this.putUser=function(e,t){return this.apiPutRequest(a.editProfile+e,t)},this.putPass=function(e,t){return this.apiPutRequest(a.editPass+e,t)},this.putEmail=function(e,t){return this.apiPutRequest(a.editEmail+e,t)},this.putFavs=function(e){return this.apiPutRequest(a.editFavs,e)},this.putCategories=function(e,t){return this.apiPutRequest(a.editCat+e,t)},this.getUserSold=function(e){return this.apiGetRequest(a.profileSold+e)},this.getUserSale=function(e){return this.apiGetRequest(a.profileSale+e)},this.getUserFavAds=function(e){return this.apiGetRequest(a.profileFavAds+e)},this.getAds=function(e){return this.apiGetRequest(e)},this.getDetailAd=function(e){return this.apiGetRequest(a.detailAd+e)},this.deleteAd=function(e,t){var o={userId:e,ad:t};return this.apiPutRequest(a.deleteAd,o)},this.filterByCategory=function(e){return this.apiGetRequest(a.categories+e)},this.newChat=function(e,t){var o={userId1:e,userId2:t};return this.apiPostRequest(a.newChat,o)},this.isNewChat=function(e,t){var o={userId1:e,userId2:t};return this.apiPostRequest(a.isNewChat,o)},this.getChats=function(e){return this.apiGetRequest(a.getChats+e)},this.getChatMessages=function(e,t){return this.apiGetRequest(a.getChatMessages+e+"/"+t)},this.filterByCategory=function(e){return this.apiGetRequest(a.categories+e)},this.filterByName=function(e){return this.apiGetRequest(a.byName+e)},this.filterAdvanced=function(e){return this.apiGetRequest(e)}}]),angular.module("WallapopTFG").service("checkAuth",["$auth","$state","states",function(e,t,a){this.checkNotLogged=function(){e.isAuthenticated()||t.go(a.mainLogRedirect)},this.checkLogged=function(){e.isAuthenticated()&&t.go(a.root)},this.isLogged=function(){return!!e.isAuthenticated()}}]),angular.module("WallapopTFG").service("errorHandler",["$state","states",function(e,t){this.handle=function(a,o){var i=!1;if(void 0!==o)for(var n=0;n<o.length;n++)if(a.code===o[n]){i=!0;break}i||(404===a.code?e.go(t.error404):500===a.code?e.go(t.error500):void 0!==a.code&&null!==a.code&&e.go(t.errorUnknown))}}]),angular.module("WallapopTFG").service("userDataStorage",["$rootScope","$auth",function(e,t){this.setUserPicture=function(a){t.isAuthenticated()&&(a=a||void 0,void 0===a?localStorage.setItem("profilePicture","http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-6.jpg"):localStorage.setItem("profilePicture",a),e.$emit("updateUserData"))},this.setUserName=function(a){t.isAuthenticated()&&(a=a||void 0,localStorage.setItem("userName",a),e.$emit("updateUserData"))},this.setUserId=function(a){t.isAuthenticated()&&(a=a||void 0,localStorage.setItem("userId",a),e.$emit("updateUserData"))},this.setUserfavAds=function(a){t.isAuthenticated()&&(a=a||void 0,localStorage.setItem("favAds",a),e.$emit("updateUserData"))},this.setUserData=function(e,t,a,o){this.setUserPicture(t),this.setUserName(e),this.setUserId(a),this.setUserfavAds(o)},this.getUserData=function(){if(t.isAuthenticated())return{userName:localStorage.getItem("userName"),profilePicture:localStorage.getItem("profilePicture"),userId:localStorage.getItem("userId"),favAds:localStorage.getItem("favAds")}},this.removeUserData=function(){t.isAuthenticated()||(localStorage.removeItem("userName"),localStorage.removeItem("profilePicture"),localStorage.removeItem("userId"),localStorage.removeItem("favAds"))},this.getUserId=function(){if(t.isAuthenticated())return localStorage.getItem("userId")},this.getUserPicture=function(){if(t.isAuthenticated())return localStorage.getItem("profilePicture")},this.setEditAd=function(e){localStorage.setItem("ad",JSON.stringify(e))},this.getEditAd=function(){return JSON.parse(localStorage.getItem("ad"))}}]);